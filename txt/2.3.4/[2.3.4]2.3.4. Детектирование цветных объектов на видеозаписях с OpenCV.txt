О занятии
1
Практическая работа
2
Итоги занятия
4
Детектирование цветных объектов  
на видеозаписях с OpenCV
Инструменты ИИ:
применяем
и программируем
2 модуль
Занятие 2.3.4

О занятии
1
Рабочая тетрадь предназначена для слушателей курса «Инструменты ИИ:
применяем и программируем».
Данное пособие поможет слушателям лучше усвоить материал,
представленный в видеоролике. Содержит практические задания  
для закрепления навыка работы с нейросетями, а также инструкции  
по регистрации и авторизации на сайтах неройсетей.
В рабочей тетради предложены термины, которые помогут лучше понять
темы и закрепить знания об искусственном интеллекте.
Цель практического занятия:
На этом занятии мы узнаем о том, как можно создавать анимации  
и небольшие видеоролики с помощью неросетей. Поймём,  
как осуществляется поиск цветных объектов на изображении.  
Напишем программу для поиска цветных объектов на сгенерированном
нейросетью видео.
Задачи:
Создать видео с помощью неройсети.
Написать программу для поиска объектов на видео.
Необходимые инструменты:
Kandinsky, Python, OpenCV, NumPy.
Занятие 2.3.4

Практическая работа
2
Задание 1
QP Перейдите по ссылке fusionbrain.ai/t2v/P
4P Выберите вкладку «Видео» на панели слеваP
VP В поле с запросом введите свой текст, установив необходимый размер  
и модель (анимация или видео).>
!P Введите запрос «Красивые большие жёлтые птицы летят над деревьями
на фоне голубого неба»P
P Нажмите «Создать видео». Время генерации 4 минутыP
P После генерации видео нажмите на кнопку «Скачать», расположенную  
в правом верхнем углуP
2P Задайте загруженному видео новое имя «video1».
Задание 2
Откройте VSC, скопируйте код из файла «Video1» из предложенных
материалов. 
Запустите программу.
Задание 3
Промпт:
Объясни построчно назначение каждой строки фрагмента кода.
while capImg.isOpened(): 
ret, frame = capImg.read() 
if not ret or frame is None: 
break  
frame_hsv = cv2.cvtColor(frame, cv2.COLOR_BGR2HSV)  
low_Yellow = np.array([20, 100, 100], dtype = "uint8") 
high_Yellow = np.array([30, 255, 255], dtype = "uint8") 
yellow_mask = cv2.inRange(frame_hsv, low_Yellow, high_Yellow) 
cv2.imshow("video_mask", yellow_mask) 
cv2.imshow("video_frame", frame) 
key_press = cv2.waitKey(30) 
if key_press == ord('q'): 
break
#height, width = frame.shape[:2]  
#crop_frame = frame[0:height, 0:width] 
#crop_frame_hsv = frame_hsv[0:height, 0:width] 
Занятие 2.3.4

3
Возможный результат (Критерии оценивания и формат оформления):
ad Запуск бесконечного цикла, пока открыто видеоизображение capImg.Z
Cd Чтение кадра из видеоизображения capImg и присвоение его переменной
frame.Z
\d Проверка на успешность чтения кадра (ret) и на наличие кадра  
в переменной frame. Если чтение не удалось или кадр отсутствует,  
то происходит выход из цикла.Z
/d Преобразование цветового пространства кадра из BGR в HSV  
и сохранение результата в переменную frame_hsv.Z
%d Получение высоты и ширины кадра и присвоение их переменным height  
и width соответственно.Z
"d Обрезка исходного кадра и сохранение результата в переменную
crop_frame.Z
Ad Обрезка кадра в цветовом пространстве HSV и сохранение результата  
в переменную crop_frame_hsv.Z
d Определение нижней и верхней границ диапазона жёлтого цвета  
в цветовом пространстве HSVd
d Создание маски, которая будет выделять пиксели с жёлтой компонентой
цвета в crop_frame_hsv, и сохранение результата в переменную
yellow_maskd
ad Отображение полученной маски на экране с названием «video_mask».Z
aad Отображение обрезанного кадра на экране с названием «video_frame».Z
aCd Ожидание нажатия клавиши и присвоение кода нажатой клавиши
переменной key_press.Z
a\d Проверка нажатой клавиши, если это 'q', то происходит выход из цикла
(выход из программы).
Задание для самостоятельной работы:
Задание 1. С помощью нейросети Kandinsky сгенерируйте видео, на котором
будут летать ласточки. 
Задание 2. Напишите программу, которая будет определять соответствующие
объекты на видео.
Занятие 2.3.4

4
Итоги занятия
На этом занятии вы:
Научились генерировать видео с помощью нейросети.
Узнали, что для чего нужна библиотека NumPy.
Составили программу, которая позволяет искать цветные объекты  
на видео.
Дальше интереснее. До встречи на следующих занятиях!
Молодцы!
Переходите на платформу для решения задач.
Увидимся на следующем занятии!
Занятие 2.3.4